+++
title = "レッスン 30"
date = "2024-05-15T8:00:00+09:00"
author = "小野寺 健"
description = "スプレッドシートでお小遣い帳を作ろう"
showFullContent = false
readingTime = false
tags = ["スプレッドシート", "表計算", "初級"]
+++
# レッスンの目標
スプレッドシートでお小遣い帳を作りましょう。
## スプレッドシートを開く
ブラウザから「スプレッドシート」を検索し、「Google スプレッドシート：ログイン」を選択して
「無題のスプレッドシート」を開きます。
## ファイル名の変更
ファイル名を「無題のスプレッドシート」から「お小遣帳」に変更します。
## タイトルの作成
2行のA列に「5」、2行のB列に「月の小遣い」を入れ、B列を太字にし、AB列に下線を引きタイトルとします。
## シート名の変更
スプレッドシートの下部にある「シート1」を右クリックし、「名前の変更」を選択して、「5月」に変更します。
## 項目の作成
4行のA列からE列までに以下のような項目名を追加し、太字にします。
| 日付 | ことがら | 入金 | 出金 | 残金 |
|-----|------|-----|-----|-----|
### 「水平方向の配置」の変更
4行のA列からE列までの項目名を選択し、「水平方向の配置」を「中央揃え」に変更します。
### 「背景色」の変更
4行のA列からE列までの項目名を選択し、「背景色」を「灰色」に塗りつぶします。
### 「罫線」の追加
4行のA列からE列までの項目名を選択し、「罫線」を「縦横全て」にします。
## 「前月の残り」欄の追加
5行目のB列（ことがら）に「前月の残り」を記入し、「水平方向の配列」を「中央揃え」にし、文字を「太字」にします。
## 記入欄の作成
6行目から25行目までを記入欄とします。
### 罫線の追加
5行目から25行目までのA列からE列までを選択し、「罫線」を「縦横全て」にして、記入欄とします。
### 残金の自動計算
入金、出金によって残金を自動計算するように残金の記入欄を変更します。
残金は「１つ前の行の残金」+「この行の入金」-「この行の出金」になります。
ただし、このままだと、入力されていない項目についてまで残金のみが表示されてしまうので`if`という条件式を使って、「ことがら」が入力されていなければ、入力されないようにします。

6行E列を選択し、`=if(`に続いて6行B列(B6)を選択し、`="", "",`と入力し、続いて5行E列を選択し(E5)、`+`を入力した後、6行C列を選択し(C6)、`-`を入力した後、6行D列を選択し(D6)、')'を入力して改行(Enter)キーを押します。
出来たら、6行E列を選択してコピーし、7行E列から25行E列まで張り付けると1行ずつずれた値になってコピーされます。
今は記入欄が空なので全て空欄が表示されます。

### 項目ごとの配置変更
6行目から25行目まで、項目（列）ごとに「水平方向の配置」を以下のように変更します。
* A,C,D,E列

    右揃え
* B列

    左揃え
### 列幅の調整
A列の「日付」は最大でも2桁までなので、半分の幅にしましょう。B列の「ことがら」は沢山書けるように２倍の幅にしましょう。
それ以外の列はそのままにします。
## 「まとめ」の作成
### 項目名の追加
27行目のA列に「まとめ」を記入し、「水平方向の配置」を「中央揃え」に、文字を太字に、罫線を下線にします。
### まとめ項目の追加
B列の28行目から32行目までに以下の5つの項目を追加し、
水平方向の配置」を「中央揃え」に、文字を太字にします。
* 前月の残り
* 入金合計
* 出金合計
* 貯金
* 今月の残り
### 集計欄の追加
上記のまとめ項目毎に集計欄を追加します。表計算機能を利用して自動的に集計するようにします。
#### 前月の残り
前月の残りは5行目（ことがら＝前月の残り）のE列（残金）と同じ内容なので28行目のC列に=を入れて、5行目のE列をクリックすると`=E5`が入力されます。
これで、5行目のE列の内容が表示されるようになります。

最後に罫線を下線にします。
#### 入金合計
入金合計は、6行目から25行目までのC列の合計になります。
このように列や行の合計を行いたい場合、`sum`という計算式を使用します。

使い方は、`sum(合計範囲)`というように指定します。
`=sum(`と入力した後、6行目から25行目までのC列を選択すると`=sum(C6:C25`と入力されるので、`)`で終了させます。
今は記入欄が空なので「0」が表示されます。

最後に罫線を下線にします。
#### 出金合計
出金合計は、6行目から25行目までのD列のうち、B列の「ことがら」が「貯金」以外のものの合計になります。
このようにある条件のものを合計したい場合、`sumif`という計算式を使用します。

使い方は`sumif(条件の範囲,条件,合計範囲)`というように指定します。条件については、以下のように記述します。
* 文字が一致する場合
    
    "文字"
* 文字が一致しない場合

    "<>文字"

`=sumif(`と入力した後、6行目から25行目までのB列を選択すると、`=sumif(B6:B25`と入力されるので、`,`を入力し、さらに`"<>貯金",`と入力し、6行目から25行目までのD列を選択すると、`=sumif(B6:B25,"<>貯金",D6:D25)`と入力されるので、`)`で終了させます。
今は記入欄が空なので「0」が表示されます。

最後に罫線を下線にします。
#### 貯金
貯金は、6行目から25行目までのD列のうち、B列の「ことがら」が「貯金」のものの合計になります。
出金合計と同じようにして、条件を`"<>貯金"`から`"貯金"`に変更します。

`=sumif(`と入力した後、6行目から25行目までのB列を選択すると、`=sumif(B6:B25`と入力されるので、`,`を入力し、さらに`"貯金",`と入力し、6行目から25行目までのD列を選択すると、`=sumif(B6:B25,"貯金",D6:D25)`と入力されるので、`)`で終了させます。
今は記入欄が空なので「0」が表示されます。

最後に罫線を下線にします。
#### 今月の残り
今月の残りは、「前月の残り」+「入金合計」-「出金合計」-「貯金」になります。
`=`の後に各項目を選択し、`+`または`-`を付けて`=C28+C29-C30-C31`になるようにします。
今は各項目がすべて「0」なので「0」が表示されます。

最後に罫線を下線にし、32行D列に「（来月へ）」を太字で入力します。

## テストデータによる確認
ここまで出来たら、正しく集計できるか以下のテストデータを入力して、確認をしましょう。
| 日付 | ことがら | 入金 | 出金 | 残金 |
|----:|------|----:|----:|----:|
|     |前月の残り|     |     | 350 |
| 1   |おこづかい| 500 |     |     |
| 3   |シール   |     | 110 |     |
|     |いたチョコ|     | 216 |     |
| 12  |プレゼント|     | 159 |     |
| 18  |おじいちゃんから| 1000 |     |     |
| 24  |絵具（赤と青）|     | 385 |     |
| 31  |貯金    |     | 20  |     |

## 出力結果
以下のように表示されれば、正解です。
| 日付 | ことがら | 入金 | 出金 | 残金 |
|----:|------|----:|----:|----:|
|     |前月の残り|     |     | 350 |
| 1   |おこづかい| 500 |     | 850 |
| 3   |シール   |     | 110 | 740 |
|     |いたチョコ|     | 216 | 524 |
| 12  |プレゼント|     | 159 | 365 |
| 18  |おじいちゃんから| 1000 |    | 1365 |
| 24  |絵具（赤と青）|     | 385 | 980 |
| 31  |貯金    |     | 20  | 920 |

|まとめ|     |     |     |
|:---:|:---:|----:|:----|
|     |前月の残り| 350 |     |
|     |入金合計| 1500 |     |
|     |出金合計| 870 |     |
|     |貯金| 20 |     |
|     |今月の残り| 960 |（来月へ）|
## 予算（計画）表を作りましょう
お小遣い帳が出来たので、次に毎月、お小遣いを何にどれくらい使うか考えて、予算（計画）表を作ります。

以下の項目に分けて、予算（計画）表を作ってみましょう。
* 勉強のため

    ノートや鉛筆、勉強に使う本、見学やその交通費など。
* 人のため

    募金や災害にあった人への献金、うちの人やお友達へのプレゼントなど。

* 遊びのため

    おもちゃ、雑誌、マンガ本、遊びに行くときの交通費、お菓子代など。

* その他

    どれにも入らないもの。

ひと月終わったら、各項目ごとに実際にどれくらい使ったか、予算（計画）と比べてみます。
### タイトルの作成
2行のI列に「予算（計画）」を入力し、2行のI列を
太字にして、下線を引きタイトルにします。 
### 予算表の作成
以下の項目の予算表を作成します。

最初の行の項目名は小遣い帳の項目と同様に、太字で灰色の背景にし、「水平方向の配置」を「中央揃え」に変更します。

「項目番号」と「ことがら」の項目も常に変わらない値なので太字にします。

また、予算（計画）についてはテストデータとして以下の値を入れておきましょう。

|項目番号|ことがら|予算（計画）|実績|
|------:|:-------|----------:|--:|
| 1 |今月のおこづかい| 500 | |
| 2 |勉強のために| 150 | |
| 3 |人のために| 100 | |
| 4 |遊びのために| 150 | |
| 5 |その他| 50 ||
| 6 |貯金| 50 | |
### 罫線の追加、列幅の調整、水平方向の配置
罫線は「縦横全て」にします。また「項目番号」はできるだけ小さめに、「ことがら」は文字がはみ出さないサイズに列幅を調整します。
「ことがら」は「左揃え」、それ以外は「右揃え」にします。
### お小遣い帳への項目番号の追加
実績を自動的に集計できるよう、お小遣い帳のF列に項目番号を追加します。
太字、背景、水平方向の配置、罫線なども合わせます。
幅はできるだけ小さめにし、G列は２つの表の区切りが分かる程度に小さくします。
### 実際の項目番号の追加
先ほどのテストデータの各「ことがら」について以下の項目番号を入力してください。（「前月の残り」については空欄のままにします）
* おこづかい：  1（今月のおこづかい）
* シール：  4（遊びのために）
* いたチョコ：  4（遊びのために）
* プレゼント：  3（人のために）
* おじいちゃんから：    1（今月のおこづかい）
* 絵具（赤と青）：  2（勉強のために）
* 貯金 ：   6（貯金）

### 実績値の集計
K列の実績を小遣い帳から自動集計するようにします。

`sumif`の計算式を使って項目番号毎に集計します。ただし、今月のおこづかいの項目は「入金」をそれ以外の項目は「出金」を集計することに注意してください。

まず、5行K列に`=sumif(`と入力した後、6行目から25行目までのF列を選択すると、`=sum(F6:F25`と入力されるので、`,`を入力し、5行H列を選択し、`,`を入力し、6行目から25行目までのC列を選択すると、`=sum(B6:B25,H5,C6:C25)`と入力されるので、`)`で終了させます。

このまま5行K列の値を6行目以降にコピーするとB6:B25、C6:C25の値まで1行ずつずれてしまうので、そうならないように`sum=(B$6:B$25,H5,C$6:C$25)`と変化してほしくない数字の前に`$`を追加します。

変更したら、5行K列の値を6行K列にコピーします。ただし、このままでは「入金」項目を集計してしまうので、`C`を`D`に書き換え`sum=(B$6:B$25,H6,D$6:D$25)`にします。（H5はH6に自動的に書き換わっています）

あとは、6行K列を7行から10行目のK列にコピーすれば終了です。
### 実績集計の確認
F行に入れた項目番号に従って、実績が以下のように正しく集計されているか確認してください。
|項目番号|ことがら|予算（計画）|実績|
|------:|:-------|----------:|--:|
| 1 |今月のおこづかい| 500 | 1500 |
| 2 |勉強のために| 150 | 385 |
| 3 |人のために| 100 | 159 |
| 4 |遊びのために| 150 | 326 |
| 5 |その他| 50 | 0 |
| 6 |貯金| 50 | 20 |
## テンプレートの完成（テストデータの削除）
テストデータによる確認が終了したら、テストデータを削除します。このとき項目名など太字の名称と、残金、実績、まとめなど自動計算の部分は削除しないように注意してください。

これでテンプレートが完成です。
## 来月分のテンプレートの作成
今月分のテンプレートをコピーして来月分のテンプレートを作成します。

その際、「今月の残り」の値を来月分の「前月の残り」に設定します。
### 今月分のテンプレートのコピー
シートの下部のタブを右クリックし、「コピーを作成」を選択してコピーを作成します。
### シートの名称の変更
コピーした来月分のシートの下部のタブを右クリックし、「名前を変更」を選択して「5月のコピー」という名称を正しい名前（例えば6月）に変更します。
### 前月の残りの設定
コピーした来月分のシートの5行目の「前月の残り」の「残金」という項目（5行E列）の値に`=`を入力し、前月のシートの下部の「今月の残り」の値（32行C列）を選択します。

## 最後に
以上で、お小遣い帳のフォーマットが完成しました。ファイルをセーブしたら、実際に自分自身や家族の小遣い帳として利用してみましょう。